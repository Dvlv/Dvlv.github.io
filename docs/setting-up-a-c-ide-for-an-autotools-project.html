<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="utf-8" />
        <title>Setting up a C IDE for an Autotools Project</title>
        <link rel="stylesheet" href="/theme/css/main.css" />
        <meta name="viewport" content="width=device-width,initial-scale=1.0">

        <!--[if IE]>
            <script src="https://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
        <script src="/theme/js/dvlv.js"></script>
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">Dvlv's Blog </a></h1>
                <div id="menu-button" onclick="showPages();">
                    <span class="line"></span><span class="line"></span><span class="line"></span>
                </div>
                <nav id="pages"><ul>
                    <li><a href="/pages/contact-me.html">Contact</a></li>
                    <li><a href="/blog.html">Blog</a></li>
                    <li><a href="/pages/tkinter-by-example.html">Tkinter By Example</a></li>
                    <li><a href="/pages/the-tkinter-cookbook.html">Tkinter Cookbook</a></li>
                    <li><a href="/pages/tkinter-gui-programming-by-example.html">Tkinter GUI Programming</a></li>
                    <li><a href="/pages/learn-flask-by-example.html">Flask By Example</a></li>
                    <li><a href="/pages/a-beginners-guide-to-fedora-silverblue.html">Silverblue Beginner's Guide</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="/setting-up-a-c-ide-for-an-autotools-project.html" rel="bookmark"
           title="Permalink to Setting up a C IDE for an Autotools Project">Setting up a C IDE for an Autotools Project</a></h1>
    </header>

    <div class="entry-content">
      <p>Coming from the world of interpreted languages (Python, Javascript, PHP) I am used to just opening a project in an IDE and having it Just Workâ„¢. I'm currently teaching
myself to code in C, and have spent more time than I would like to admit just getting an IDE set up to autocomplete and catch syntax errors. In this post, I will go over how I managed to get VSCodium set up with a C language server, and how to get it to recognise imported libraries. Hopefully this post can help someone else from having the same struggles, or just be useful to my future self if I take a break.</p>
<h2 id="build-systems">Build Systems</h2>
<p>Many people complain that Python has too many ways of handling dependencies - <code>pip</code>, <code>pyenv</code>, <code>poetry</code>, <code>pipenv</code>. It seems to me that C has the same problem. There's
<code>cmake</code>, <code>meson</code>, <code>autotools</code>, <code>ninja</code>, and probably more. Some of these will come with tools to generate the necessary files for an IDE to work with the project, but not all of them. Some of them also require learning their DSL, which I'm not interested in doing <em>before</em> I can start a project.</p>
<p>The majority of projects I am interested in diving into are using Autotools, which is <em>not</em> one of the build systems which generates <code>compile_commands.json</code>. This is what caused me so much annoyance when trying to set up an IDE.</p>
<h2 id="how-the-ides-language-servers-work">How the IDEs / Language Servers Work</h2>
<p>The standard for the Language Servers I have looked at seems to be a file called <code>compile_commands.json</code>, which is typically auto-generated by the build process. This contains the steps to build the application, letting the Language Server know where to look for libraries and headers.</p>
<p>In order to generate this for a project which doesn't do it automatically, we can use a tool called Bear:</p>
<p><a href="https://github.com/rizsotto/Bear" target="_blank">Bear on Github.</a></p>
<p>This is a project-agnostic tool to generate the <code>compile_commands.json</code> file automatically from a regular Makefile.</p>
<h2 id="setting-up-the-ide">Setting up the IDE</h2>
<p>For this example I will be using VSCodium. The steps in this post should, however, apply to any IDE using <code>ccls</code> or <code>clangd</code> as a Language Server. </p>
<h3 id="set-up-ccls">Set up CCLS</h3>
<p><a href="https://github.com/MaskRay/ccls" target="_blank">Grab CCLS and install it as per the instructions</a>. On Fedora Silverblue 36, this involves building it
from source (in a toolbox). I then used the "Shell script wrapper" instructions to do a pretend "install" to <code>/usr/bin</code>.</p>
<h3 id="add-ccls-to-vscodium">Add CCLS to VSCodium</h3>
<p>Install the <code>vscode-ccls</code> extension.</p>
<h2 id="generating-compile_commandsjson-in-an-autotools-project">Generating <code>compile_commands.json</code> in an Autotools Project</h2>
<p>Now that the language server is installed and integrated, we can go ahead and begin building our project. I will use the current instructions from 
<a href="https://github.com/ostreedev/ostree" target="_blank">OSTree</a> as an example, but this should work for any Autotools project.</p>
<pre><code class="language-bash">git submodule update --init
env NOCONFIGURE=1 ./autogen.sh
./configure --prefix=...
make
make install DESTDIR=/path/to/dest
</code></pre>
<p>Begin by following the instructions <em>up to the point where we run <code>make</code></em>. For our example, this is the <code>git</code> command, the <code>autogen.sh</code> script, and the <code>./configure</code>.</p>
<p>Now we run <code>make</code> but pass it through <code>bear</code>, like so:</p>
<pre><code class="language-bash">bear -- make
</code></pre>
<p>This will run the Makefile <em>and</em> generate <code>compile_commands.json</code> for us. Nifty!</p>
<h2 id="import-the-project-into-the-ide">Import the Project Into the IDE</h2>
<p>With this done, we should be able to open the project in VSCodium and let ccls provide us with auto-complete and syntax checking!</p>
    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>Useful Links</h2>
                        <ul>
                        <li><a target="_blank" href="https://github.com/Dvlv"  >Github</a></li>
                        <li><a target="_blank" href="/pages/js-licence.html" data-jslicense="1" >Javascript Licence</a></li>
                        </ul>
                </div><!-- /.blogroll -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body"></footer><!-- /#contentinfo -->

</body>
</html>